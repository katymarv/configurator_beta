{"version":3,"file":"RateCurve.js","sources":["../src/js/RateCurve.js"],"sourcesContent":["import FC from \"./fc\";\nimport { API_VERSION_1_43 } from \"./data_storage\";\nimport semver from \"semver\";\n\nconst minRc = 1000;\nconst midRc = 1500;\nconst maxRc = 2000;\nconst RateCurve = function (useLegacyCurve) {\n    this.useLegacyCurve = useLegacyCurve;\n    this.maxAngularVel = null;\n\n    this.constrain = function (value, min, max) {\n        return Math.max(min, Math.min(value, max));\n    };\n\n    this.rcCommand = function (rcData, rcRate, deadband) {\n        const tmp = Math.min(Math.max(Math.abs(rcData - midRc) - deadband, 0), 500);\n\n        let result = tmp * rcRate;\n\n        if (rcData < midRc) {\n            result = -result;\n        }\n\n        return result;\n    };\n\n    this.drawRateCurve = function (rate, rcRate, rcExpo, superExpoActive, deadband, limit, maxAngularVel, context, width, height) {\n        const canvasHeightScale = height / (2 * maxAngularVel);\n\n        const stepWidth = context.lineWidth;\n\n        context.save();\n        context.translate(width / 2, height / 2);\n\n        context.beginPath();\n        let rcData = minRc;\n        context.moveTo(-500, -canvasHeightScale * this.rcCommandRawToDegreesPerSecond(rcData, rate, rcRate, rcExpo, superExpoActive, deadband, limit));\n        rcData = rcData + stepWidth;\n        while (rcData <= maxRc) {\n            context.lineTo(rcData - midRc, -canvasHeightScale * this.rcCommandRawToDegreesPerSecond(rcData, rate, rcRate, rcExpo, superExpoActive, deadband, limit));\n\n            rcData = rcData + stepWidth;\n        }\n        context.stroke();\n\n        context.restore();\n    };\n\n    this.drawLegacyRateCurve = function (rate, rcRate, rcExpo, context, width, height) {\n        // math magic by englishman\n        let rateY = height * rcRate;\n        rateY = rateY + (1 / (1 - ((rateY / height) * rate)));\n\n        // draw\n        context.beginPath();\n        context.moveTo(0, height);\n        context.quadraticCurveTo(width * 11 / 20, height - ((rateY / 2) * (1 - rcExpo)), width, height - rateY);\n        context.stroke();\n    };\n\n    this.drawStickPosition = function (rcData, rate, rcRate, rcExpo, superExpoActive, deadband, limit, maxAngularVel, context, stickColor) {\n\n        const DEFAULT_SIZE = 60; // canvas units, relative size of the stick indicator (larger value is smaller indicator)\n        const rateScaling  = (context.canvas.height / 2) / maxAngularVel;\n\n        const currentValue = this.rcCommandRawToDegreesPerSecond(rcData, rate, rcRate, rcExpo, superExpoActive, deadband, limit);\n\n        if(rcData!=undefined) {\n            context.save();\n            context.fillStyle = stickColor || '#000000';\n\n            context.translate(context.canvas.width/2, context.canvas.height/2);\n            context.beginPath();\n            context.arc(rcData-1500, -rateScaling * currentValue, context.canvas.height / DEFAULT_SIZE, 0, 2 * Math.PI);\n            context.fill();\n            context.restore();\n        }\n        return (Math.abs(currentValue)<0.5)?0:currentValue.toFixed(0); // The calculated value in deg/s is returned from the function call for further processing.\n    };\n\n    this.getBetaflightRates = function (rcCommandf, rcCommandfAbs, rate, rcRate, rcExpo, superExpoActive, limit) {\n        let angularVel;\n\n        if (rcRate > 2) {\n            rcRate = rcRate + (rcRate - 2) * 14.54;\n        }\n\n        let expoPower;\n        let rcRateConstant;\n\n        expoPower = 3;\n        rcRateConstant = 200;\n\n        if (rcExpo > 0) {\n            rcCommandf =  rcCommandf * Math.pow(rcCommandfAbs, expoPower) * rcExpo + rcCommandf * (1-rcExpo);\n        }\n\n        if (superExpoActive) {\n            const rcFactor = 1 / this.constrain(1 - rcCommandfAbs * rate, 0.01, 1);\n            angularVel = rcRateConstant * rcRate * rcCommandf; // 200 should be variable checked on version (older versions it's 205,9)\n            angularVel = angularVel * rcFactor;\n        } else {\n            angularVel = (((rate * 100) + 27) * rcCommandf / 16) / 4.1; // Only applies to old versions ?\n        }\n\n        angularVel = this.constrain(angularVel, -1 * limit, limit); // Rate limit from profile\n\n        return angularVel;\n    };\n\n    this.getRaceflightRates = function (rcCommandf, rate, rcRate, rcExpo) {\n        let angularVel = ((1 + 0.01 * rcExpo * (rcCommandf * rcCommandf - 1.0)) * rcCommandf);\n        angularVel = (angularVel * (rcRate + (Math.abs(angularVel) * rcRate * rate * 0.01)));\n        return angularVel;\n    };\n\n    this.getKISSRates = function (rcCommandf, rcCommandfAbs, rate, rcRate, rcExpo) {\n        const kissRpy = 1 - rcCommandfAbs * rate;\n        const kissTempCurve = rcCommandf * rcCommandf;\n        rcCommandf = ((rcCommandf * kissTempCurve) * rcExpo + rcCommandf * (1 - rcExpo)) * (rcRate / 10);\n        return ((2000.0 * (1.0 / kissRpy)) * rcCommandf);\n    };\n\n    this.getActualRates = function (rcCommandf, rcCommandfAbs, rate, rcRate, rcExpo) {\n        let angularVel;\n        const expof = rcCommandfAbs * ((Math.pow(rcCommandf, 5) * rcExpo) + (rcCommandf * (1 - rcExpo)));\n\n        angularVel = Math.max(0, rate-rcRate);\n        angularVel = (rcCommandf * rcRate) + (angularVel * expof);\n\n        return angularVel;\n    };\n\n    this.getQuickRates = function (rcCommandf, rcCommandfAbs, rate, rcRate, rcExpo) {\n        rcRate = rcRate * 200;\n        rate = Math.max(rate, rcRate);\n\n        let angularVel;\n        const superExpoConfig = (((rate / rcRate) - 1) / (rate / rcRate));\n        const curve = Math.pow(rcCommandfAbs, 3) * rcExpo + rcCommandfAbs * (1 - rcExpo);\n\n        angularVel = 1.0 / (1.0 - (curve * superExpoConfig));\n        angularVel = rcCommandf * rcRate * angularVel;\n\n        return angularVel;\n    };\n\n    this.getCurrentRates = function () {\n\n        const currentRates = {\n            roll_rate:          FC.RC_TUNING.roll_rate,\n            pitch_rate:         FC.RC_TUNING.pitch_rate,\n            yaw_rate:           FC.RC_TUNING.yaw_rate,\n            rc_rate:            FC.RC_TUNING.RC_RATE,\n            rc_rate_yaw:        FC.RC_TUNING.rcYawRate,\n            rc_expo:            FC.RC_TUNING.RC_EXPO,\n            rc_yaw_expo:        FC.RC_TUNING.RC_YAW_EXPO,\n            rc_rate_pitch:      FC.RC_TUNING.rcPitchRate,\n            rc_pitch_expo:      FC.RC_TUNING.RC_PITCH_EXPO,\n            superexpo:          FC.FEATURE_CONFIG.features.isEnabled('SUPEREXPO_RATES'),\n            deadband:           FC.RC_DEADBAND_CONFIG.deadband,\n            yawDeadband:        FC.RC_DEADBAND_CONFIG.yaw_deadband,\n            roll_rate_limit:    FC.RC_TUNING.roll_rate_limit,\n            pitch_rate_limit:   FC.RC_TUNING.pitch_rate_limit,\n            yaw_rate_limit:     FC.RC_TUNING.yaw_rate_limit,\n        };\n\n        currentRates.superexpo = true;\n\n        if (semver.gte(FC.CONFIG.apiVersion, API_VERSION_1_43)) {\n            switch (FC.RC_TUNING.rates_type) {\n                case FC.RATES_TYPE.RACEFLIGHT:\n                    currentRates.roll_rate *= 100;\n                    currentRates.pitch_rate *= 100;\n                    currentRates.yaw_rate *= 100;\n                    currentRates.rc_rate *= 1000;\n                    currentRates.rc_rate_yaw *= 1000;\n                    currentRates.rc_rate_pitch *= 1000;\n                    currentRates.rc_expo *= 100;\n                    currentRates.rc_yaw_expo *= 100;\n                    currentRates.rc_pitch_expo *= 100;\n\n                    break;\n                case FC.RATES_TYPE.ACTUAL:\n                    currentRates.roll_rate *= 1000;\n                    currentRates.pitch_rate *= 1000;\n                    currentRates.yaw_rate *= 1000;\n                    currentRates.rc_rate *= 1000;\n                    currentRates.rc_rate_yaw *= 1000;\n                    currentRates.rc_rate_pitch *= 1000;\n\n                    break;\n                case FC.RATES_TYPE.QUICKRATES:\n                    currentRates.roll_rate *= 1000;\n                    currentRates.pitch_rate *= 1000;\n                    currentRates.yaw_rate *= 1000;\n\n                    break;\n                default:           // add future rates types here\n\n                    break;\n            }\n        }\n\n        return currentRates;\n    };\n};\n\nRateCurve.prototype.rcCommandRawToDegreesPerSecond = function (rcData, rate, rcRate, rcExpo, superExpoActive, deadband, limit) {\n    let angleRate;\n\n    if (rate !== undefined && rcRate !== undefined && rcExpo !== undefined) {\n        let rcCommandf = this.rcCommand(rcData, 1, deadband);\n        if (semver.gte(FC.CONFIG.apiVersion, API_VERSION_1_43)) {\n            rcCommandf = rcCommandf / (500 - deadband);\n        } else {\n            rcCommandf = rcCommandf / 500;\n        }\n\n        const rcCommandfAbs = Math.abs(rcCommandf);\n\n        switch (FC.RC_TUNING.rates_type) {\n            case FC.RATES_TYPE.RACEFLIGHT:\n                angleRate=this.getRaceflightRates(rcCommandf, rate, rcRate, rcExpo);\n\n                break;\n\n            case FC.RATES_TYPE.KISS:\n                angleRate=this.getKISSRates(rcCommandf, rcCommandfAbs, rate, rcRate, rcExpo);\n\n                break;\n\n            case FC.RATES_TYPE.ACTUAL:\n                angleRate=this.getActualRates(rcCommandf, rcCommandfAbs, rate, rcRate, rcExpo);\n\n                break;\n\n            case FC.RATES_TYPE.QUICKRATES:\n                angleRate=this.getQuickRates(rcCommandf, rcCommandfAbs, rate, rcRate, rcExpo);\n\n                break;\n\n            // add future rates types here\n            default: // BetaFlight\n                angleRate=this.getBetaflightRates(rcCommandf, rcCommandfAbs, rate, rcRate, rcExpo, superExpoActive, limit);\n\n                break;\n        }\n    }\n\n    return angleRate;\n};\n\nRateCurve.prototype.getMaxAngularVel = function (rate, rcRate, rcExpo, superExpoActive, deadband, limit) {\n    let maxAngularVel;\n    if (!this.useLegacyCurve) {\n        maxAngularVel = this.rcCommandRawToDegreesPerSecond(maxRc, rate, rcRate, rcExpo, superExpoActive, deadband, limit);\n    }\n\n    return maxAngularVel;\n};\n\nRateCurve.prototype.setMaxAngularVel = function (value) {\n    this.maxAngularVel = Math.ceil(value/200) * 200;\n\n    return this.maxAngularVel;\n};\n\nRateCurve.prototype.draw = function (rate, rcRate, rcExpo, superExpoActive, deadband, limit, maxAngularVel, context) {\n    if (rate !== undefined && rcRate !== undefined && rcExpo !== undefined) {\n        const height = context.canvas.height;\n        const width = context.canvas.width;\n\n        if (this.useLegacyCurve) {\n            this.drawLegacyRateCurve(rate, rcRate, rcExpo, context, width, height);\n        } else {\n            this.drawRateCurve(rate, rcRate, rcExpo, superExpoActive, deadband, limit, maxAngularVel, context, width, height);\n        }\n    }\n};\n\nexport default RateCurve;\n"],"names":[],"mappings":"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"}